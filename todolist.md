根据你的最新需求和建议，下面是**更新后的 todolist**，重点突出“利用窗口/控件名判据，极少用 OCR/截图比对”，并明确平台适配方案：

---

## autoWeComLite 跨平台自动化项目 todolist（最新版）

### 1. 项目初始化与结构设计
- [ ] 新建项目目录（如 `autoWeComLite`）
- [ ] 设计跨平台的项目结构（如 `core/`, `ui/`, `automation/`, `config/`, `assets/` 等）
- [ ] 初始化 `requirements.txt`，仅包含 wxPython、pyautogui、pygetwindow、pyperclip、pywinauto（Win）、Pillow 及必要依赖
- [ ] 编写 README，说明项目目标、依赖、安装和运行方式

### 2. 跨平台自动化能力梳理与优化
- [ ] 设计高鲁棒性自动化流程，**优先用窗口/控件名判据**，极少用 OCR/截图比对
- [ ] 用 pygetwindow 管理窗口，pywinauto（Win）/AppleScript（Mac）获取控件名和焦点
- [ ] 所有操作步骤（窗口聚焦、联系人搜索、消息输入、发送）都用窗口/控件名检测完成，避免 sleep
- [ ] 平台差异（如快捷键、窗口名、控件名）用变量和 platform.system() 判断
- [ ] 失败自动重试，详细日志记录

### 3. UI 设计与实现（wxPython）
- [ ] 只实现两个页面：  
    - [ ] “消息发送”页面（联系人、内容、发送、日志）
    - [ ] “设置”页面（平台选择、参数配置）
- [ ] 设计主窗口（MainFrame）：菜单栏、内容区、状态栏
- [ ] 实现页面切换和基础交互

### 4. 自动化功能实现（pyautogui 及相关库）
- [ ] 实现窗口聚焦（pygetwindow，必要时平台分支）
- [ ] 实现联系人搜索（快捷键+剪贴板+控件名检测）
- [ ] 实现消息输入（剪贴板+控件名检测）
- [ ] 实现消息发送（快捷键+控件名检测）
- [ ] 所有自动化流程用 callback 或 future/promise 控制，便于 UI 反馈和异常处理

### 5. 配置与平台适配
- [ ] 设计配置文件（如 `config/settings.py`），支持平台切换
- [ ] 自动检测当前操作系统，自动适配自动化实现
- [ ] 提供用户自定义配置入口（如窗口名、快捷键、延迟、重试次数等）

### 6. 测试与兼容性验证
- [ ] 在 macOS 上完整测试所有功能
- [ ] 在 Windows 上完整测试所有功能
- [ ] 修复平台差异导致的 bug，确保体验一致

### 7. 打包与分发
- [ ] 使用 pyinstaller 或类似工具，分别为 macOS 和 Windows 打包可执行文件
- [ ] 编写详细的打包和安装说明

### 8. 文档与维护
- [ ] 完善 README，包含功能说明、安装运行、常见问题
- [ ] 编写开发文档，便于后续维护和扩展

---

如需进一步细化某一部分（如 pywinauto/AppleScript 控件名判据的具体用法），可随时补充！
